---
description: Funzionamento di Gestione driver
title: Funzionalità di gestione driver | Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: reference
helpviewer_keywords:
- driver manager [ODBC], backward compatibility
- compatibility [ODBC], driver manager
- ODBC driver manager [ODBC]
- backward compatibility [ODBC], driver manager
ms.assetid: 57f65c38-d9ee-46c8-9051-128224a582c6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: d210d5c202f11151cf22a64362b652958422f513
ms.sourcegitcommit: 33f0f190f962059826e002be165a2bef4f9e350c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/30/2021
ms.locfileid: "99158164"
---
# <a name="what-the-driver-manager-does"></a>Funzionamento di Gestione driver
Nella tabella seguente viene riepilogato il modo in cui gestione driver ODBC *3. x* esegue il mapping delle chiamate ai driver ODBC *2. x* e ODBC *3. x* .  
  
|Funzione or<br /><br /> attributo di istruzione|Commenti|  
|-----------------------------------------|--------------|  
|SQL_ATTR_FETCH_BOOKMARK_PTR|Punta al segnalibro da usare con **SQLFetchScroll**. Di seguito sono riportati i dettagli di implementazione:<br /><br /> -Quando un'applicazione imposta questa impostazione in un driver ODBC *2. x* , gestione driver ODBC *3. x* lo memorizza nella cache. Dereferenzia il puntatore e passa il valore al driver ODBC *2. x* nell'argomento *FetchOffset* di **SQLExtendedFetch** quando **SQLFetchScroll** viene chiamato successivamente dall'applicazione.<br />-Quando un'applicazione imposta questa impostazione in un driver ODBC *3. x* , la gestione driver ODBC *3. x* passa la chiamata al driver.|  
|SQL_ATTR_ROW_STATUS_PTR|Punta alla matrice di stato della riga compilata da **SQLFetch**, **SQLFetchScroll**, **SQLBulkOperations** e **SQLSetPos**. Di seguito sono riportati i dettagli di implementazione:<br /><br /> -Quando un'applicazione imposta questa impostazione in un driver ODBC *2. x* , il relativo valore viene memorizzato in Gestione driver ODBC *3. x* . Passa questo valore al driver ODBC *2. x* nell'argomento *RowStatusArray* di **SQLExtendedFetch** quando viene chiamato **SQLFetchScroll** o **SQLFetch** .<br />-Quando un'applicazione imposta questa impostazione in un driver ODBC *3. x* , la gestione driver ODBC *3. x* passa la chiamata al driver.<br />-In stato S6, se un'applicazione imposta SQL_ATTR_ROW_STATUS_PTR e quindi chiama **SQLBulkOperations** (con un' *operazione* di SQL_ADD) o **SQLSetPos** senza prima chiamare **SQLFetch** o **SQLFetchScroll**, viene restituito SQLState HY011 (l'attributo non può essere impostato adesso).|  
|SQL_ATTR_ROWS_FETCHED_PTR|Punta al buffer in cui **SQLFetch** e **SQLFetchScroll** restituiscono il numero di righe recuperate. Di seguito sono riportati i dettagli di implementazione:<br /><br /> -Quando un'applicazione imposta questa impostazione in un driver ODBC *2. x* , il relativo valore viene memorizzato in Gestione driver ODBC *3. x* . Passa questo valore al driver ODBC *2. x* nell'argomento *RowCountPtr* di **SQLExtendedFetch** quando **SQLFetch** o **SQLFetchScroll** viene chiamato dall'applicazione.<br />-Quando un'applicazione imposta questa impostazione in un driver ODBC *3. x* , la gestione driver ODBC *3. x* passa la chiamata al driver.|  
|SQL_ATTR_ROW_ARRAY_SIZE|Imposta la dimensione del set di righe. Di seguito sono riportati i dettagli di implementazione:<br /><br /> -Quando un'applicazione imposta questa impostazione in un driver ODBC *2. x* , gestione driver ODBC *3. x* ne esegue il mapping all'attributo dell'istruzione SQL_ROWSET_SIZE.<br />-Quando un'applicazione imposta questa impostazione in un driver ODBC *3. x* , la gestione driver ODBC *3. x* passa la chiamata al driver.<br />-Quando un'applicazione che utilizza un driver ODBC *3. x* chiama **SQLSetScrollOptions**, SQL_ROWSET_SIZE viene impostato sul valore nell'argomento *RowsetSize* se il driver sottostante non supporta **SQLSetScrollOptions**.|  
|SQL_ROWSET_SIZE|Imposta le dimensioni del set di righe utilizzate da **SQLExtendedFetch** quando **SQLExtendedFetch** viene chiamato da un'applicazione ODBC *2. x* . Di seguito sono riportati i dettagli di implementazione:<br /><br /> -Quando un'applicazione imposta questa impostazione, gestione driver ODBC *3. x* passa la chiamata al driver, indipendentemente dalla versione del driver.<br />-Quando un'applicazione che utilizza un driver ODBC *2. x* chiama **SQLSetScrollOptions**, SQL_ROWSET_SIZE viene impostato sul valore nell'argomento **RowsetSize** .|  
|**SQLBulkOperations**|Esegue un'operazione di inserimento o aggiorna, Elimina o recupera dalle operazioni di segnalibro. Di seguito sono riportati i dettagli di implementazione:<br /><br /> -Quando un'applicazione chiama **SQLBulkOperations** con un' *operazione* di SQL_ADD in un driver ODBC *2. x* , gestione driver ODBC *3. x* ne esegue il mapping a **SQLSetPos** con un' *operazione* di SQL_ADD.<br />-Quando si utilizza un driver ODBC *2. x* che non supporta **SQLSetPos** con un' *operazione* di SQL_ADD, gestione driver ODBC *3. x* non esegue il mapping di **SQLSetPos** con un' *operazione* di SQL_ADD a **SQLBulkOperations** con un' *operazione* di SQL_ADD. Questo perché non è possibile chiamare **SQLBulkOperations** nello stato S7, che in ODBC *2. x* è l'unico stato in cui è possibile chiamare **SQLSetPos** .<br />-Se l'applicazione chiama **SQLBulkOperations** con un' *operazione* di SQL_ADD in un driver ODBC *2. x* prima di chiamare **SQLFetchScroll**, gestione driver ODBC *3. x* restituisce un errore.|  
|**SQLExtendedFetch**|Restituisce il set di righe specificato. Ad eccezione della restrizione appena nota, gestione driver ODBC *3. x* passa le chiamate a **SQLExtendedFetch** al driver, indipendentemente dalla versione del driver.|  
|**SQLFetch**|Restituisce il set di righe successivo. Di seguito sono riportati i dettagli di implementazione:<br /><br /> -Quando un'applicazione chiama **SQLFetch** in un driver ODBC *2. x* , gestione driver ODBC *3. x* ne esegue il mapping a **SQLExtendedFetch**. L'argomento *FetchOrientation* di **SQLExtendedFetch** è impostato su SQL_FETCH_NEXT. Gestione driver utilizza il valore memorizzato nella cache dell'attributo dell'istruzione SQL_ATTR_ROW_STATUS_PTR per l'argomento *RowStatusArray* e il valore memorizzato nella cache dell'attributo dell'istruzione SQL_ATTR_ROWS_FETCHED_PTR per l'argomento *RowCountPtr* .<br />-Un'applicazione *ODBC 3. x* può combinare le chiamate **a SQLFetch** e **SQLFetchScroll** in un driver ODBC *2. x* perché il gestore di driver ODBC *3. x* esegue il mapping di **SQLFetch** a **SQLExtendedFetch** quando viene chiamato da un'applicazione in un driver ODBC *2. x* .<br />-Se un driver ODBC *2. x* non supporta **SQLExtendedFetch**, gestione driver ODBC *3. x* non esegue il mapping di **SQLFetch** o **SQLFetchScroll** a **SQLExtendedFetch** quando un'applicazione lo chiama in tale driver. Se l'applicazione tenta di impostare SQL_ATTR_ROW_ARRAY_SIZE su un valore maggiore di 1, viene restituito SQLSTATE HYC00 (funzionalità facoltativa non implementata).<br />-Ad eccezione delle restrizioni appena indicate, gestione driver ODBC *3. x* passa le chiamate a **SQLFetch** al driver, indipendentemente dalla versione del driver.|  
|**SQLFetchScroll**|Restituisce il set di righe specificato. Di seguito sono riportati i dettagli di implementazione:<br /><br /> -Quando un'applicazione chiama **SQLFetchScroll** in un driver ODBC *2. x* , gestione driver ODBC *3. x* ne esegue il mapping a **SQLExtendedFetch**. Usa il valore memorizzato nella cache dell'attributo dell'istruzione SQL_ATTR_ROW_STATUS_PTR per l'argomento *RowStatusArray* e il valore memorizzato nella cache dell'attributo dell'istruzione SQL_ATTR_ROWS_FETCHED_PTR per l'argomento *RowCountPtr* . Se l'argomento *FetchOrientation* in **SQLFetchScroll** è SQL_FETCH_BOOKMARK, viene usato il valore memorizzato nella cache dell'attributo dell'istruzione SQL_ATTR_FETCH_BOOKMARK_PTR per l'argomento *FetchOffset* e viene restituito un errore se l'argomento *FetchOffset* di **SQLFetchScroll** non è 0.<br />-Quando un'applicazione chiama questa operazione in un driver ODBC *3. x* , la gestione driver ODBC *3. x* passa la chiamata al driver.|  
|**SQLSetPos**|Esegue diverse operazioni posizionate. Gestione driver ODBC *3. x* passa le chiamate a **SQLSetPos** al driver, indipendentemente dalla versione del driver.|  
|**SQLSetScrollOptions**|Quando Gestione driver esegue il mapping di **SQLSetScrollOptions** per un'applicazione che utilizza un driver ODBC *3. x* che non **supporta SQLSetScrollOptions**, gestione driver imposta l'opzione dell'istruzione SQL_ROWSET_SIZE, non l'attributo dell'istruzione SQL_ATTR_ROW_ARRAY_SIZE, sull'argomento *RowsetSize* in **SQLSetScrollOption**. Di conseguenza, **SQLSetScrollOptions** non può essere utilizzato da un'applicazione durante il recupero di più righe mediante una chiamata a **SQLFetch** o **SQLFetchScroll**. Può essere utilizzato solo quando si recuperano più righe tramite una chiamata a **SQLExtendedFetch**.|
